# 🔐 Google Sheets 權限設定指南

## 📋 服務帳號資訊

**服務帳號 Email：**
```
places-api-service@localbizfinder-477001.iam.gserviceaccount.com
```

**所需權限：** **編輯者**（Editor）

---

## 🎯 設定步驟

### 步驟 1：開啟 Google Sheets

1. 訪問 [Google Sheets](https://sheets.google.com/)
2. 找到您的試算表（使用 `GOOGLE_SHEETS_ID`）
3. 開啟試算表

### 步驟 2：開啟共用設定

1. **點擊右上角的「共用」按鈕**（Share button）
   - 通常顯示為一個帶有「+」圖示的按鈕
   - 或顯示為「共用」文字按鈕

### 步驟 3：檢查現有權限

**在「與使用者和群組共用」區域中：**

1. **查找服務帳號 Email：**
   ```
   places-api-service@localbizfinder-477001.iam.gserviceaccount.com
   ```

2. **確認權限等級：**
   - 如果顯示「編輯者」→ ✅ 權限正確
   - 如果顯示「檢視者」或「註解者」→ ⚠️ 需要更新
   - 如果未找到 → ❌ 需要新增

### 步驟 4-A：新增服務帳號（如果未找到）

1. **在「新增使用者和群組」欄位中輸入：**
   ```
   places-api-service@localbizfinder-477001.iam.gserviceaccount.com
   ```

2. **點擊右側的權限下拉選單**

3. **選擇「編輯者」**

4. **點擊「傳送」或「完成」**

   **注意：** 如果系統提示「找不到這個使用者」，這是正常的。服務帳號不需要接受邀請，會自動獲得權限。

### 步驟 4-B：更新現有權限（如果權限不正確）

1. **找到服務帳號 Email 在共用列表中**

2. **點擊權限下拉選單**（通常顯示為「檢視者」或「註解者」）

3. **選擇「編輯者」**

4. **確認變更**

### 步驟 5：驗證權限

1. **確認服務帳號 Email 顯示在共用列表中**

2. **確認權限等級顯示為「編輯者」**

3. **關閉共用對話框**

---

## 📸 視覺指南

### 共用按鈕位置

```
┌─────────────────────────────────────┐
│  Google Sheets 標題列                │
│  [檔案] [編輯] [檢視] ... [共用] ← 這裡 │
└─────────────────────────────────────┘
```

### 共用對話框

```
┌─────────────────────────────────────────────┐
│  與使用者和群組共用                           │
├─────────────────────────────────────────────┤
│  [新增使用者和群組] [輸入 Email]              │
│                                              │
│  與使用者和群組共用：                         │
│  ┌───────────────────────────────────────┐ │
│  │ places-api-service@...iam.gservice... │ │
│  │ [編輯者 ▼]                            │ │
│  └───────────────────────────────────────┘ │
└─────────────────────────────────────────────┘
```

---

## ✅ 權限確認檢查清單

請確認以下項目：

- [ ] 服務帳號 Email 已新增到共用列表
- [ ] 權限等級設定為「編輯者」
- [ ] 沒有錯誤訊息
- [ ] 已關閉共用對話框

---

## 🆘 常見問題

### Q1：系統提示「找不到這個使用者」

**A：** 這是正常的。服務帳號不需要接受邀請，會自動獲得權限。直接點擊「完成」即可。

### Q2：無法找到「編輯者」選項

**A：** 確保您有權限管理試算表的共用設定。如果您不是試算表的所有者，可能需要請所有者設定。

### Q3：權限設定後仍然無法寫入

**A：** 
1. 確認權限已正確設定（重新檢查）
2. 確認服務帳號 Email 正確（沒有拼寫錯誤）
3. 等待幾分鐘讓權限生效
4. 重新啟動開發伺服器

### Q4：如何確認服務帳號是否有權限？

**A：** 
1. 開啟 Google Sheets
2. 點擊「共用」按鈕
3. 在共用列表中查找服務帳號 Email
4. 確認權限等級為「編輯者」

---

## 📝 回報格式

**請使用以下格式回報權限狀態：**

```
【權限確認結果】

✅ 服務帳號 places-api-service@localbizfinder-477001.iam.gserviceaccount.com 
   已設定為「編輯者」權限
   設定時間：2025-01-15 15:30:00
```

或

```
【權限確認結果】

❌ 服務帳號未在共用列表中
   已新增為「編輯者」權限
   設定時間：2025-01-15 15:30:00
```

或

```
【權限確認結果】

⚠️ 服務帳號權限為「檢視者」
   已更新為「編輯者」權限
   設定時間：2025-01-15 15:30:00
```

---

**完成權限設定後，請重新執行測試！** 🔐










